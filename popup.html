<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>YouTube AI Ask and Summarize</title>
    <style>
      :root {
        color-scheme: light dark;
        font-family: "Segoe UI", Roboto, sans-serif;
        font-size: 14px;
      }
      body {
        margin: 0;
        padding: 16px;
        min-width: 220px;
      }
      h2 {
        margin: 16px 0 8px;
        font-size: 13px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.4px;
      }
      h1 {
        margin: 0 0 12px;
        font-size: 15px;
        font-weight: 600;
      }
      label {
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 500;
      }
      label.disabled {
        opacity: 0.6;
      }
      .select-row {
        justify-content: space-between;
      }
      select,
      input[type="password"] {
        flex: 1;
        padding: 6px 8px;
        border-radius: 6px;
        border: 1px solid rgba(128, 128, 128, 0.4);
        font: inherit;
      }
      select {
        max-width: 140px;
      }
      .key-section {
        display: flex;
        flex-direction: column;
        gap: 4px;
        margin-top: 12px;
        padding: 8px;
        border-radius: 8px;
        border: 1px solid transparent;
      }
      .key-label {
        font-size: 12px;
        font-weight: 600;
      }
      .key-section.active {
        border-color: rgba(62, 166, 255, 0.5);
        background: rgba(62, 166, 255, 0.08);
      }
      textarea {
        width: 100%;
        min-height: 80px;
        resize: vertical;
        padding: 6px 8px;
        border-radius: 6px;
        border: 1px solid rgba(128, 128, 128, 0.4);
        font: inherit;
      }
      .custom-prompt {
        margin-top: 8px;
      }
      p {
        margin: 8px 0 0;
        font-size: 12px;
        color: rgba(128, 128, 128, 0.9);
      }
      .hint {
        margin-top: 16px;
      }
      .upgrade-btn {
        display: block;
        padding: 8px 12px;
        background: #3ea6ff;
        color: white;
        text-decoration: none;
        border-radius: 6px;
        text-align: center;
        font-weight: 600;
        margin: 8px 0;
      }
      .upgrade-btn:hover {
        background: #2d95ff;
      }
      .upgrade-note {
        font-size: 11px;
        color: rgba(128, 128, 128, 0.9);
        margin: 4px 0 0;
      }
      #validateCode {
        padding: 4px 8px;
        margin-left: 8px;
        border-radius: 4px;
        border: 1px solid rgba(128, 128, 128, 0.4);
        background: #3ea6ff;
        color: white;
        font: inherit;
        cursor: pointer;
      }
      #validateCode:hover {
        background: #2d95ff;
      }
      #premiumStatus {
        margin: 4px 0 0;
        font-size: 12px;
      }
    </style>
  </head>
  <body>
    <h1>YouTube AI Ask and Summarize</h1>
    <label>
      <input type="checkbox" id="autoSummarize" />
      Auto recap & Q&A
    </label>
    <p id="status" aria-live="polite"></p>

    <div id="usageSection">
      <h2>Usage</h2>
      <p id="usageDisplay">Loading usage...</p>
      <div id="premiumSection" hidden>
        <label class="key-label" for="premiumCode">Premium Code</label>
        <input type="password" id="premiumCode" placeholder="Enter your premium code" autocomplete="off" />
        <button type="button" id="validateCode">Validate Code</button>
        <p id="premiumStatus"></p>
      </div>
      <div id="upgradeSection" hidden>
        <a href="https://www.paypal.com/ncp/payment/YQF6YXJSRQNTY" target="_blank" class="upgrade-btn">
          ðŸš€ Upgrade to Premium - $7.99
        </a>
        <p class="upgrade-note">Get unlimited summaries! You'll receive a premium code after payment.</p>
      </div>
    </div>

    <h2>AI Provider</h2>
    <label class="select-row">
      <span>Choose AI model</span>
      <select id="provider">
        <option value="openrouter">OpenRouter.ai</option>
        <option value="gemini">Gemini</option>
        <option value="gpt">GPT (OpenAI)</option>
        <option value="claude">Claude (Anthropic)</option>
        <option value="ollama">Ollama (Local)</option>
      </select>
    </label>

    <label class="select-row">
      <span>Response style</span>
      <select id="summaryMode">
        <option value="bullets">Bullets</option>
        <option value="detailed">Deeper paragraphs</option>
        <option value="chapters">Chapters with timestamps</option>
        <option value="proscons">Pros & Cons analysis</option>
        <option value="recipe">Recipe/Step format</option>
        <option value="outline">Structured outline</option>
        <option value="custom">Custom prompt</option>
      </select>
    </label>

    <label>
      <input type="checkbox" id="includeTimestamps" checked />
      Include clickable timestamps
    </label>

    <div class="custom-prompt" id="customPromptContainer" hidden>
      <label class="key-label" for="customPrompt">Custom instructions</label>
      <textarea id="customPrompt" placeholder="Describe how the summary should be generated"></textarea>
    </div>

    <!-- Chrome on-device summarizer removed for performance; language selector omitted. -->

    <section class="key-section" data-provider="openrouter">
      <label class="key-label" for="openrouterKey">OpenRouter API key</label>
      <input type="password" id="openrouterKey" placeholder="Paste OpenRouter key (works with DeepSeek free)" autocomplete="off" />
      <div class="row" style="margin-top: 6px; gap: 8px; align-items: center;">
        <button type="button" id="getOpenRouterKey" style="padding: 6px 10px; border-radius: 6px; border: 1px solid rgba(128,128,128,0.4); background: #3ea6ff; color: #fff; font: inherit; cursor: pointer;">Get free key</button>
        <span style="font-size: 11px; color: rgba(128,128,128,0.9);">Opens a guided setup</span>
      </div>
      <div class="model-row">
        <label class="key-label" for="openrouterModel">Model</label>
        <select id="openrouterModel">
          <option value="x-ai/grok-4-fast:free">Grok 4 Fast (free)</option>
          <option value="mistralai/mistral-7b-instruct:free">Mistral 7B Instruct (free)</option>
          <option value="deepseek/deepseek-chat-v3.1:free">DeepSeek Chat v3.1 (free)</option>
          <option value="nvidia/nemotron-nano-9b-v2:free">NVIDIA Nemotron Nano 9B v2 (free)</option>
        </select>
      </div>
      <p class="help">Choose a free model; Grok 4 Fast is recommended for best performance.</p>
    </section>

    <section class="key-section" data-provider="gemini">
      <label class="key-label" for="geminiKey">Gemini API key</label>
      <input type="password" id="geminiKey" placeholder="Paste Gemini key" autocomplete="off" />
    </section>

    <section class="key-section" data-provider="gpt">
      <label class="key-label" for="openaiKey">OpenAI API key</label>
      <input type="password" id="openaiKey" placeholder="Paste OpenAI key" autocomplete="off" />
    </section>

    <section class="key-section" data-provider="claude">
      <label class="key-label" for="claudeKey">Anthropic API key</label>
      <input type="password" id="claudeKey" placeholder="Paste Claude key" autocomplete="off" />
    </section>


    <section class="key-section" data-provider="ollama">
      <label class="key-label" for="ollamaUrl">Ollama Server URL</label>
      <input type="text" id="ollamaUrl" placeholder="http://localhost:11434" autocomplete="off" />
      <div class="model-row">
        <label class="key-label" for="ollamaModel">Model</label>
        <select id="ollamaModel">
          <option value="llama3.2">Llama 3.2 (3B)</option>
          <option value="llama3.2:1b">Llama 3.2 (1B)</option>
          <option value="llama3.1">Llama 3.1 (8B)</option>
          <option value="qwen2.5">Qwen 2.5 (7B)</option>
          <option value="mistral">Mistral (7B)</option>
          <option value="phi3">Phi-3 (3.8B)</option>
        </select>
      </div>
      <p class="help">Runs locally on your machine. Install Ollama and pull a model first.</p>
    </section>

    <p class="hint">Ask questions about any video content! Keys stored locally via Chrome sync.</p>
    <script src="popup.js" type="module"></script>
  </body>
</html>
